<!DOCTYPE html />
<html>
    <head>
        <meta charset="utf-8" />
        <title>ISO Map</title>
        <style type="text/css">
            #GameScreen {
                position:  absolute;
                left: 0;
                top: 0;
                width:  100%;
                height:  100%;
                background:  black;
            }
        </style>
        <script type="text/javascript" src="scripts/lib/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="scripts/lib/base-builder-iso.js"></script>
        <script type="text/javascript">
            $(function () {
                var map = new ISOBase(document.getElementById('GameScreen'));
                map.GridVx = { x: 65.28, y: 32.64 };
                map.GridVy = { x: -65.28, y: 32.64 };

                map.initialize();

                //Habitation Module
                var objid = map.mapObject_Add("gfx/obj/habitation.svg#Plane", null, { x: 426.97, y: 258.32 }, { width: 4, height: 5 }, { name: 'Habitation Module' });
                map.MapObjects[objid].addComponent("gfx/obj/habitation.svg#HabitationCyl2", null, { x: 426.97, y: 258.32 }, { width: 4, height: 5 });

                var stage = map.Screen.find('.ISOMapStage');
                var view = map.Screen.find('.ISOMapView');

                for (var i = 0; i < map.MapSize.x; i += 4) {
                    for (var j = 0; j < map.MapSize.y; j += 5) {
                        var po = map.MapObjects[objid].placeOnMap(map, i, j);
                        $(po.groupelement).click(function () {
                            var po = $(this).data('isomapplacedobject');
                            alert(po.attributes.name + " (" + po.x + ", " + po.y + ")");
                        });
                        $(po.groupelement).mouseenter(function () {
                            var po = $(this).data('isomapplacedobject');
                            console.log('Enter ' + po.attributes.name);

                            map.setEncompassCursor(po.x, po.y);
                        });
                        /*
                        $(po.groupelement).mouseleave(function () {
                        var po = $(this).data('isomapplacedobject');
                        console.log('Enter ' + po.attributes.name);
                        });
                        */
                    }
                }
                map.centerOn(32, 32);

                /*
                stage.mousemove(function (e) {
                    var grid = map.screenToGrid(e.offsetX, e.offsetY);
                    map.setEncompassCursor(grid.x, grid.y);
                });
                */
            });
        </script>

    </head>
    <body>
        <div id="GameScreen"></div>
    </body>
</html>